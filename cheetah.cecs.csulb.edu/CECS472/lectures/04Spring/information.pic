\def\chapternumber{CECS 472, Information Movement --- Volper -- 13 August 2003}
\input slides.tex
\input cstuff.tex
\centerline{\bbf Information Movement in Networks}

\centerline{\bbf Tables in Files}

A solution for small numbers of hosts, small amount of information:

Hosts Table: {\ltt{}/etc/hosts}

\halign{#\hfil\quad&\quad#\hfil\quad&\quad#\hfil\cr
internet&host&nick\cr
address&name&names\cr
\noalign{\vskip 0.2in}
134.139.248.31&aardvark.cecs.csulb.edu&aardvark\cr
134.139.248.19&puma.net.cecs.csulb.edu&puma\cr}

Ethernet Table: {\ltt{}/etc/ethers}
\break
Services Table: {\ltt{}/etc/services}
\break
Account information: {\ltt{}/etc/password}
\vt
Disadvantage: You must update the file on each machine you own.
\newslide
\centerline{\bbf NIS}
\centerline{Network Information System}

Protocol made public by Sun Microsystems
\break
Maintains data bases on a small network
\break
In a network of machines replaces files that are normally the
same on all machines:
\break
{\ltt{}password},
{\ltt{}hosts},
{\ltt{}groups},
{\ltt{}services},
{\ltt{}hosts.equiv},
{\ltt{}exports}
\break
Can be used for general purpose data.

Master/slave/client model
\break
The master server contains the information.
\break
The slave servers contain copies of the information
\break
The clients get information from a server (master/slave)
\break
Hashes information for efficiency (map).

Updating information:
\break
Update the master {\bit map}
\break
Propagate the change to the slave servers
\break
(slaves save complete copy on disk)
\break
Next time a client inquires, the server has the new information.

Disadvantages:
\break
Takes 10 minutes for change to propagate on a campus
network (15 slave servers).
\break
If a client can't find a server, it can't get information.
(For example, no password information means no logins.)

\newslide
\centerline{\bbf Finding Internet Numbers}

Needed to connect: an internet address
\break
Have: an internet name

{\ltt{}gethostbyname}: Given an internet name, get back an internet address

Methods: local file, NIS, domain name service
\break
or combinations thereof

Example: (1) try the local file; 
\break
if a miss (2) try the network data base (nis/yp)
\break
if a miss (3) try the Domain Name Service
\vt
Others may do different orders or special lookups.

\newslide
\centerline{\bbf Domain Name Service}

client--server: client calls the local server, the local server delivers
the name.

server ({\ltt{}named}): searches for the name.

The name tree. Every level knows the names/numbers of servers of the
next level down.

{\railroadfont
.PS
vert=0.7i
horiz=0.5i
Root: circle "."
Mil: circle with .c at Root.c + (-5*horiz,-vert) "mil"
Com: circle with .c at Root.c + (-3*horiz,-vert) "com"
Edu: circle with .c at Root.c + (0,-vert) "edu"
Org: circle with .c at Root.c + (3*horiz,-vert) "org"
Gov: circle with .c at Root.c + (5*horiz,-vert) "gov"
Mit: circle with .c at Edu.c + (-3*horiz,-vert) "mit"
Csulb: circle with .c at Edu.c + (0,-vert) "csulb"
Ucla: circle with .c at Edu.c + (3*horiz,-vert) "ucla"
Acs: circle with .c at Csulb.c + (-3*horiz,-vert) "acs"
Cecs: circle with .c at Csulb.c + (0,-vert) "cecs"
Lib: circle with .c at Csulb.c + (3*horiz,-vert) "lib"
line from Root.sw to Mil.ne
line from Root.sw to Com.ne
line from Root.s to Edu.n
line from Root.se to Org.nw
line from Root.se to Gov.nw
line from Edu.sw to Mit.ne
line from Edu.s to Csulb.n
line from Edu.se to Ucla.nw
line from Csulb.sw to Acs.ne
line from Csulb.s to Cecs.n
line from Csulb.se to Lib.nw
.PE
\centerline{\box\graph}}

{\ltt{}cheetah.cecs.csulb.edu}
\break
1) ask . (root) server.
\break
Answer--here is address of {\ltt{}edu} server
\break
2) ask {\ltt{}edu} server.
\break
Answer--here is address of {\ltt{}csulb.edu} server
\break
3) ask {\ltt{}csulb.edu} server.
\break
Answer--here is address of {\ltt{}cecs.csulb.edu} server
\break
4) ask {\ltt{}cecs.csulb.edu} (root) server.
\break
Answer--{\ltt{}134.139.248.2}
\newslide
\centerline{\bbf SNMP}
\centerline{Simple Network Management Protocol}

%Comer: Chapter 25; 
RFC 1067 (original), RFCs 1155--58

Provides IP and TCP level management capabilities.
\break
Same capabilities on all IP gateways and machines.
\break
(provided by {\ltt{}snmpd})
\break
A variety of user interfaces.

snmpd = server
\break
user interface = client

SNMP (internet board) / CMOT (ISO) two protocols for management.

In common: {\bbf MIB} Management Information Base
\break
(several extensions)

Idea: The most important thing is to spot problems.
\break
Information is the key to spotting problems.

\newslide
\centerline{\bbf SNMP Data}
\vt
Hierarchical organization of information
\break
(nested record structure/tree structure)
\break
MIB is a subtree

Outer record: 3 components iso, ccitt, joint (iso-ccitt)
\break
(for machine encoding components are numbered)
\break
Encoding is called ASN.1
\break
1 (iso), 2 (ccitt), 3 (joint)

Internet information:
\break
iso.org.dod.internet.mgmt.mib  (1.3.6.1.2.1)

Issue: thousands of name/number mappings.
\newslide
\centerline{\bbf NTP --- Network Time Protocol}

Issue: If clocks aren't synchronized, you can't tell what happened when.

Example: Make--did you compile before/after updating the source. 

Caveat: You can't synchronize, but you can come close.

Two methods for synchronizing:

{\ltt{}timed} -- Master/slave. A designated master time server.
If master server dies, slaves elect a new master.

{\ltt{}ntp} -- (RFC-1059) Servers/clients. Synchronizes from a set of servers.
More accurate/more reliable.
Requires internet access.
Client asks server, what time is it.

Master server: National Observatory/Annapolis

Servers divided by stratum.

Stratum = distance (hops) from Observatory clock.

Stratum 1 = radio clock link to National Observatory
\break
San Diego Supercomputer Center
\break
NORAD
\newslide
\centerline{\bbf Issues}

Delay: How to get 10 msec accuracy when RTT is 40-100 msec
\break
If RTT is 100 msec,
time stamp is 0--100 msec old.
\break
Was the RTT half there, half back: can't tell. 
\break
How much delay in server.
\break
Example:
\break 40 msec there, 10 msec server delay, 50 msec back

Solution: Guess half RTT. Track long term time and drift
\vt

Adjustment: Jumping the clock back is bad, new things have older times.
Jumping the clock ahead is okay,

Solution: Gradually adjust. Slow down/speed up the clock
\break
Typically, clock tics every few microseconds, add/ignore a tic occasionally
({\ltt{}adjtime}).
\vt

Divergence: what do you when servers diverge.

Decision: pick one of the low stratum servers to synchronize with.

Effect: If the server/connection goes bad, you follow.

\newslide
\centerline{{\bbf Issues} {\brm (con'd)}}
\vt
Consistancy: Local consistancy is more important than exact time.

300 msec error on off campus mail
\break
20 msec error on time stamp of file

Problem: some redundancy needed in case one server crashes.

Solution: have a couple local servers
\break
All local machines sync to these servers.
\break
Local servers sync to same remote servers (so the local servers don't diverge).

Solution 2: buy a gps cards for a couple servers.
\newslide
\centerline{\bbf SMTP}
\centerline{Simple Mail Transport Protocol}
\centerline{(RFC 821)}

Problem: find where the mail goes
\vt
Examples:

{\ltt{}cs472z2}  --- local, find {\ltt{}/usr/spool/mail/cs472z2}

{\ltt{}volper@cecs.csulb.edu} --- tcp/ip port 25, 134.139.249.5

{\ltt{}volper@puma.net.cecs.csulb.edu} --- local

Requirement: A powerful parser to analyze destination addresses. 

Basic choices:

1) internet site: send direct (tcp/ip)

2) dial up: save in spool until a phone call is made

3) other net: send to a gateway

4) local: drop in file

Other issue: site/gateway down = queue and send later
\newslide
\centerline{\bbf sendmail}

A widely used SMTP transfer program.

Usually run as a ``server".
\break
Accepts any outgoing messages and tries to send.
\break
Accepts any incoming messages and puts them in the users mail spool file.
\break
Tries to send any mail in the queue once each hour.

Listens on port 25;
when it needs to send it calls the other machine on port 25 (peer-to-peer)
\bye
