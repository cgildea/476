\def\chapternumber{amd -- 23 November 1998}
\input slides.tex
\centerline{\bbf Network File System}
\centerline{automatic mounts}

Situation: you have alot of NFS mounts,
\break
many are infrequently used.

Regular NFS mount: Error if server goes offline.

Solution: keep unused NFS mount in the unmounted state.
\break
automatically mount when needed.

A {\ltt{}cd}, {\ltt{}ls} or other program that needs something
in an NFS area triggers a NFS mount.

If a NFS mount hasn't been used in a while,
\break
(timeout period), unmount it.

Sun: {\ltt{}automount}
\break
Linux: {\ltt{}amd}
\newslide
\centerline{\bbf automount}

invoke with the name of the config file
\break
{\ltt{}automount -f /etc/auto.master}

Maintains maps (remote FS -- mount point)
\break
Direct and indirect (full path vs. relative path)

{\ltt{}auto.master}:
\break
{\ltt{}/- /etc/auto.direct}
\break
One map, full path

{\ltt{}auto.direct}

{\program
/net/cheetah/u1 -rw,intr,soft cheetah.cecs.csulb.edu/u1
/net/lab21/etc -rw,intr,soft lab21.net.cecs.csulb.edu/etc
\endprogram}

Some versions handle dependent mounts

{\ltt{}/net/lynx}, {\ltt{}/net/lynx/u1}
\break
(usefull for diskless machines)

Behavior: file system calls already handle NFS.
\break
Open calls previewed by automount,
\break
which does mount.
\break
Appears as the local NFS server program to OS
\break
mounts in temp, then creates a link
\newslide
\centerline{\bbf amd}

4.4 BSD automounter (public)

{\ltt{}amd [-a mount_point ] directory mapname}

attaches as a local nfs server to the specified directories.

Actually it attaches them in a special directory then builds links.

Warning: keep mount directories unused by regular mounts
\break
and by standard NFS mounts.

{\cprogram
# amd.net (config file)
/net/lynx/u1 \
  type:=host;\
  rhost:=lynx.cecs.csulb.edu;\
  fs:=/tmp_mnt/${key};\
  opts:=ro,soft,intr
@endprogram}

Can use variables, {\ltt{}key} matches first line,
\break
Can program mounts {\ltt{}arch=x86}, {\ltt{}host!=lynx}
\bye
